!function(e,n){"object"==typeof exports&&"object"==typeof module?module.exports=n():"function"==typeof define&&define.amd?define("jexpeval",[],n):"object"==typeof exports?exports.jexpeval=n():e.jexpeval=n()}(self,(()=>(()=>{"use strict";var e={d:(n,r)=>{for(var t in r)e.o(r,t)&&!e.o(n,t)&&Object.defineProperty(n,t,{enumerable:!0,get:r[t]})}};e.g=function(){if("object"==typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"==typeof window)return window}}(),e.o=(e,n)=>Object.prototype.hasOwnProperty.call(e,n),e.r=e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})};var n={};e.r(n),e.d(n,{jexpeval:()=>u});var r,t=["Compound","Identifier","MemberExpression","Literal","ThisExpression","CallExpression","UnaryExpression","BinaryExpression","ConditionalExpression","ArrayExpression"],o=function(){function e(n,r,t){void 0===r&&(r=e.genericCallerSolver),void 0===t&&(t=e.genericValuesSolver),this._parser=n,this._caller=r,this._values=t}return e.genericCallerSolver=function(e,n){return new Promise((function(n,r){n("`".concat(e,"`"))}))},e.genericValuesSolver=function(e){return new Promise((function(n,r){n("`".concat(e,"`"))}))},e.genericCallerUnknowParser=function(e,n){return new Promise((function(r,t){if("function"!=typeof e)throw"JSEP is not defined";var o=e(n);if("object"!=typeof o)throw"Value returned in JSEP is not array";if(!o.hasOwnProperty("type"))throw"Value returned in JSEP dont contain 'type' item.";r(o)}))},e.getType=function(e){return"object"==typeof e&&e.hasOwnProperty("type")&&t.indexOf(e.type)?e.type:null},e}(),i=(r=function(e,n){return r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,n){e.__proto__=n}||function(e,n){for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])},r(e,n)},function(e,n){if("function"!=typeof n&&null!==n)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");function t(){this.constructor=e}r(e,n),e.prototype=null===n?Object.create(n):(t.prototype=n.prototype,new t)}),u=function(n){function r(){return null!==n&&n.apply(this,arguments)||this}return i(r,n),r.convertToPrintable=function(e){return 1},r.prototype.eval=function(n,t){var o=this;if(void 0===t&&(t=!1),"string"!=typeof n)throw"Eval input in jexpeval isnot string";return new Promise((function(i,u){o._parser(n).then((function(n){var l=o.constructor.getType(n);if(null===l)throw"Invalid type in lex eval.";new e.g[l](o._parser,o._caller,o._values).eval(n).then((function(e){return i(t?r.convertToPrintable(e):e)})).catch((function(e){return u(e)}))}))}))},r.run=function(e,n,t,i,u){return void 0===n&&(n=!1),void 0===i&&(i=o.genericCallerSolver),void 0===u&&(u=o.genericValuesSolver),new r(t,i,u).eval(e,n)},r.runAsWorker=function(e,n,t,i,u,l){if(void 0===n&&(n=!1),void 0===i&&(i=null),void 0===u&&(u=o.genericCallerSolver),void 0===l&&(l=o.genericValuesSolver),!window)throw"[jexpeval] worker only avaliable on browser: window dont exists.";if(!Worker)throw"[jexpeval] worker only avaliable on browser: Worker dont exists.";if(null===(i=null!==typeof i?i:window.jcemWorkerCreator&&"function"==typeof window.jcemWorkerCreator?window.jcemWorkerCreator:null))throw"[runAsWorker] creator dont exists.";return i({parser:function(e){return new Promise((function(e,n){e({return:1,id:""})}))},caller:function(e){return u(e.name,e.args)},values:function(e){return l(e.name)}},(function(t){new r((function(e){return t("parser",[])}),(function(e,n){return t("caller",{name:e,args:n})}),(function(e){return t("values",{name:e})})).eval(e,n).catch((function(e){})).then((function(e){}))}))},r}(o);return n})()));