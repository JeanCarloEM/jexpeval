!function(e,r){"object"==typeof exports&&"object"==typeof module?module.exports=r():"function"==typeof define&&define.amd?define("jexpeval",[],r):"object"==typeof exports?exports.jexpeval=r():e.jexpeval=r()}(self,(()=>(()=>{"use strict";var e={d:(r,t)=>{for(var n in t)e.o(t,n)&&!e.o(r,n)&&Object.defineProperty(r,n,{enumerable:!0,get:t[n]})}};e.g=function(){if("object"==typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"==typeof window)return window}}(),e.o=(e,r)=>Object.prototype.hasOwnProperty.call(e,r),e.r=e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})};var r={};e.r(r),e.d(r,{jexpeval:()=>u});var t=["Compound","Identifier","MemberExpression","Literal","ThisExpression","CallExpression","UnaryExpression","BinaryExpression","ConditionalExpression","ArrayExpression"],n=function(){function e(r,t,n){void 0===t&&(t=e.genericCallerSolver),void 0===n&&(n=e.genericValuesSolver),this._parser=r,this._caller=t,this._values=n}return e.genericCallerSolver=function(e,r){return new Promise((function(r,t){r("`".concat(e,"`"))}))},e.genericValuesSolver=function(e){return new Promise((function(r,t){r("`".concat(e,"`"))}))},e.genericCallerUnknowParser=function(e,r){return new Promise((function(t,n){if("function"!=typeof e)throw"JSEP is not defined";var o=e(r);if("object"!=typeof o)throw"Value returned in JSEP is not array";if(!o.hasOwnProperty("type"))throw"Value returned in JSEP dont contain 'type' item.";t(o)}))},e.getType=function(e){return"object"==typeof e&&e.hasOwnProperty("type")&&t.indexOf(e.type)?e.type:null},e}(),o=function(){return o=Object.assign||function(e){for(var r,t=1,n=arguments.length;t<n;t++)for(var o in r=arguments[t])Object.prototype.hasOwnProperty.call(r,o)&&(e[o]=r[o]);return e},o.apply(this,arguments)},a=function(e,r){var t={};for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&r.indexOf(n)<0&&(t[n]=e[n]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var o=0;for(n=Object.getOwnPropertySymbols(e);o<n.length;o++)r.indexOf(n[o])<0&&Object.prototype.propertyIsEnumerable.call(e,n[o])&&(t[n[o]]=e[n[o]])}return t};function i(e){function r(e){return"object"!=typeof e?"[jexpeval][runAsWorker][worker] message isnot object.":e.hasOwnProperty("data")?"object"!=typeof e.data?"[jexpeval][runAsWorker][worker] data of message isnot object.":"":"[jexpeval][runAsWorker][worker] message dont contain 'data' proprerty."}function t(e,t){var n=a(t,[]);return new Promise((function(t,a){(function(e,t,n){var o=!1;return new Promise((function(a,i){self.addEventListener("message",(function(t){if(!o){var n=r(t);if((n=0===n.trim().length?t.data.hasOwnProperty("return")?"string"!=typeof t.data.id?"[jexpeval][runAsWorker][worker] message 'id' in 'customPromiseMessage' isnot string value.":0===t.data.id.trim().length?"[jexpeval][runAsWorker][worker] message 'id' in 'customPromiseMessage' is empty.":"":"[jexpeval][runAsWorker][worker] message in 'customPromiseMessage' dont contain 'return' proprerty.":n).trim().length>0)return i(n);t.data.id===e&&(o=!0,a(t.data.return))}})),self.postMessage({caller:t,args:n,id:e})}))})("uid10000000100040008000100000000000".replace(/[018]/g,(function(e){var r=e;return(r^crypto.getRandomValues(new Uint8Array(1))[0]&15>>r/4).toString(16)})),e,o({},n)).catch((function(e){return a(e)})).then((function(e){return t(e)}))}))}self.addEventListener("message",(function(n){var o=r(n);if((o=0===o.trim().length?n.data.hasOwnProperty("start")?"boolean"!=typeof n.data.start?"[jexpeval][runAsWorker][worker] message 'eval' isnot boolean value.":n.data.hasOwnProperty("printable")?"boolean"!=typeof n.data.printable?"[jexpeval][runAsWorker][worker] message 'printable' isnot boolean value.":"":"[jexpeval][runAsWorker][worker] message dont contain 'printable' proprerty.":"[jexpeval][runAsWorker][worker] message dont contain 'eval' proprerty.":o).trim().length>0)return self.postMessage({error:o});n.data.hasOwnProperty("start")&&e(t)}))}var s,l=(s=function(e,r){return s=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,r){e.__proto__=r}||function(e,r){for(var t in r)Object.prototype.hasOwnProperty.call(r,t)&&(e[t]=r[t])},s(e,r)},function(e,r){if("function"!=typeof r&&null!==r)throw new TypeError("Class extends value "+String(r)+" is not a constructor or null");function t(){this.constructor=e}s(e,r),e.prototype=null===r?Object.create(r):(t.prototype=r.prototype,new t)}),u=function(r){function t(){return null!==r&&r.apply(this,arguments)||this}return l(t,r),t.convertToPrintable=function(e){return 1},t.prototype.eval=function(r,n){var o=this;if(void 0===n&&(n=!1),"string"!=typeof r)throw"Eval input in jexpeval isnot string";return new Promise((function(a,i){o._parser(r).then((function(r){var s=o.constructor.getType(r);if(null===s)throw"Invalid type in lex eval.";new e.g[s](o._parser,o._caller,o._values).eval(r).then((function(e){return a(n?t.convertToPrintable(e):e)})).catch((function(e){return i(e)}))}))}))},t.run=function(e,r,o,a,i){return void 0===r&&(r=!1),void 0===a&&(a=n.genericCallerSolver),void 0===i&&(i=n.genericValuesSolver),new t(o,a,i).eval(e,r)},t.runAsWorker=function(e,r,o,a,s){return void 0===r&&(r=!1),void 0===a&&(a=n.genericCallerSolver),void 0===s&&(s=n.genericValuesSolver),function(e,r){if(!window)throw"[jexpeval] worker only avaliable on browser: window dont exists.";if(!Worker)throw"[jexpeval] worker only avaliable on browser: Worker dont exists.";var t=function(e){var r=window.URL.createObjectURL(new Blob(["(",i.toString(),")(",e.toString(),")"],{type:"text/javascript"}));return console.warn(r),new Worker(r)}(r);return new Promise((function(r,n){t.addEventListener("message",(function(o){var a="object"!=typeof o?"[jexpeval][runAsWorker][window] message isnot object.":o.hasOwnProperty("data")?"object"!=typeof o.data?"[jexpeval][runAsWorker][window] data of message isnot object.":"":"[jexpeval][runAsWorker][window] message dont contain 'data' proprerty.";if((a=0===(a=0===a.trim().length&&o.data.hasOwnProperty("error")?o.data.error.trim():a).trim().length?function(){if(o.data.hasOwnProperty("caller")){if("string"!=typeof o.data.caller)return"[jexpeval][runAsWorker][window] caller of message isnot string.";if(o.data.caller=o.data.caller.trim(),0===o.data.caller.length)return"[jexpeval][runAsWorker][window] caller of message is empty.";if(!e.hasOwnProperty(o.data.caller))return"[jexpeval][runAsWorker][window] the caller name does not exist.";if("function"!=typeof e[o.data.caller])return"[jexpeval][runAsWorker][window] caller name is not a function."}return""}():a).trim().length>0||o.data.hasOwnProperty("return"))return t.terminate(),a.trim().length>0?n(a):r(o.data.return);if(o.data.hasOwnProperty("caller"))return e[o.data.caller](o.data.hasOwnProperty("args")?o.data.args:[]).then((function(e,r){t.postMessage({return:e,id:r})}));throw"[jexpeval][runAsWorker][window] It was not expected that the execution would reach this line."})),t.postMessage({start:!0})}))}({parser:function(){},caller:function(){},values:function(){}},(function(n){new t((function(e){return n("parser",[])}),(function(e,r){return n("caller",[])}),(function(e){return n("values",[])})).eval(e,r).catch((function(e){})).then((function(e){}))}))},t}(n);return r})()));